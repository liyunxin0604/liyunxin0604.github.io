<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="generator" content="Aspose.Words for .NET 15.1.0.0" /><title>最新oneindex OneDrive目录索引直链搭建教程-小心2007的博客</title><link rel="shortcut icon" href="/favicon.ico" /></head><body><div><p style="margin:0pt; orphans:0; widows:0"><a style="color:#0563c1" href="https://xx2007.cf/help.html"><span style="color:#0563c1; font-family:等线; font-size:14pt; font-weight:bold; text-decoration:underline">&lt;</span><span style="color:#0563c1; font-family:等线; font-size:14pt; font-weight:bold; text-decoration:underline">&lt;返回</span></a></p><p style="margin:0pt; orphans:0; text-align:center; widows:0"><a style="color:#0563c1" href="https://xx2007.cf"><span style="color:#0563c1; font-family:等线; font-size:14pt; font-weight:bold; text-decoration:underline">小心2</span><span style="color:#0563c1; font-family:等线; font-size:14pt; font-weight:bold; text-decoration:underline">007</span></a></p><p style="margin:0pt; orphans:0; text-align:center; widows:0"><span style="font-family:等线; font-size:14pt; font-weight:bold">最新oneindex</span><span style="font-family:等线; font-size:14pt; font-weight:bold"> </span><span style="font-family:等线; font-size:14pt; font-weight:bold">OneDrive目录索引直链搭建教程</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:14pt">&#xa0;</span></p><p style="margin:0pt; orphans:0; text-indent:21pt; widows:0"><span style="font-family:等线; font-size:11pt">OneDrive很好用，但是就是分享链接访问不了。下面教你无成本搭建</span><span style="font-family:等线; font-size:11pt">OneDrive目录索引直链</span><span style="font-family:等线; font-size:11pt">。这是个开源项目，GitHub地址为：</span><a style="color:#0563c1" href="https://github.com/spencerwooo/onedrive-cf-index"><span style="color:#0563c1; font-family:等线; font-size:11pt; text-decoration:underline">https://github.com/spencerwooo/onedrive-cf-index</span></a></p><p style="margin:0pt; orphans:0; text-indent:21pt; widows:0"><span style="font-family:等线; font-size:11pt">#原来的方法获取refresh</span><span style="font-family:等线; font-size:11pt">-</span><span style="font-family:等线; font-size:11pt">token的链接被墙了(所有github</span><span style="font-family:等线; font-size:11pt">.io</span><span style="font-family:等线; font-size:11pt">都被墙了)，所以我重新搭建了一个，代码是一样的，所以还是归原作者所有。</span></p><p style="margin:0pt; orphans:0; text-indent:21pt; widows:0"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="margin:0pt; orphans:0; text-indent:21pt; widows:0"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="margin:0pt; orphans:0; text-indent:21pt; widows:0"><span style="font-family:等线; font-size:11pt">去这里</span><a style="color:#0563c1" href="https://portal.azure.com/%23blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade"><span style="color:#0563c1; font-family:等线; font-size:11pt; text-decoration:underline">https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade</span></a><span style="font-family:等线; font-size:11pt">新建一个应用</span></p><p style="margin:0pt; orphans:0; widows:0"><img src="https://i.xx2007.workers.dev/blog/20210221/398e4245-c56d-4bf4-946f-e02feb20dc6b.001.png" width="554" height="212" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="margin:0pt; orphans:0; widows:0"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">名称随便填，箭头指示的地方按下图中选。</span><span style="font-family:等线; font-size:11pt">重定向url填写：</span><a style="color:#0563c1" href="https://onetool.xx2007.cf/tools/microsoft-graph-api-auth"><span style="color:#0563c1; font-family:等线; font-size:11pt; text-decoration:underline">https://onetool.xx2007.cf/tools/microsoft-graph-api-auth</span></a></p><p style="margin:0pt; orphans:0; widows:0"><img src="https://i.xx2007.workers.dev/blog/20210221/398e4245-c56d-4bf4-946f-e02feb20dc6b.002.png" width="554" height="324" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">点注册。之后点进你刚刚创建的应用，点左侧api权限</span></p><p style="margin:0pt; orphans:0; widows:0"><img src="https://i.xx2007.workers.dev/blog/20210221/398e4245-c56d-4bf4-946f-e02feb20dc6b.003.png" width="554" height="215" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">点添加权限</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">点M</span><span style="font-family:等线; font-size:11pt">i</span><span style="font-family:等线; font-size:11pt">crosoft</span><span style="font-family:等线; font-size:11pt"> </span><span style="font-family:等线; font-size:11pt">graph</span><span style="font-family:等线; font-size:11pt">.</span></p><p style="margin:0pt; orphans:0; widows:0"><img src="https://i.xx2007.workers.dev/blog/20210221/398e4245-c56d-4bf4-946f-e02feb20dc6b.004.png" width="554" height="443" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">点委托的权限。</span></p><p style="margin:0pt; orphans:0; widows:0"><img src="https://i.xx2007.workers.dev/blog/20210221/398e4245-c56d-4bf4-946f-e02feb20dc6b.005.png" width="554" height="206" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">添加如下四个权限</span></p><p style="margin:0pt; orphans:0; widows:0"><img src="https://i.xx2007.workers.dev/blog/20210221/398e4245-c56d-4bf4-946f-e02feb20dc6b.006.png" width="554" height="158" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">左侧点证书和密码</span></p><p style="margin:0pt; orphans:0; widows:0"><img src="https://i.xx2007.workers.dev/blog/20210221/398e4245-c56d-4bf4-946f-e02feb20dc6b.007.png" width="554" height="147" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">添加新客户端密码</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">选择从不</span></p><p style="margin:0pt; orphans:0; widows:0"><img src="https://i.xx2007.workers.dev/blog/20210221/398e4245-c56d-4bf4-946f-e02feb20dc6b.008.png" width="554" height="108" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">添加</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">复制</span><span style="font-family:等线; font-size:11pt">客户端</span><span style="font-family:等线; font-size:11pt">密码</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">注意只有一次机会！！！！！</span></p><p style="margin:0pt; orphans:0; widows:0"><img src="https://i.xx2007.workers.dev/blog/20210221/398e4245-c56d-4bf4-946f-e02feb20dc6b.009.png" width="554" height="40" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">点左侧概述，复制客户端id</span></p><p style="margin:0pt; orphans:0; widows:0"><img src="https://i.xx2007.workers.dev/blog/20210221/398e4245-c56d-4bf4-946f-e02feb20dc6b.010.png" width="554" height="50" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">在</span><a style="color:#0563c1" href="https://onetool.xx2007.cf/tools/microsoft-graph-api-auth"><span style="color:#0563c1; font-family:等线; font-size:11pt; text-decoration:underline">https://onetool.xx2007.cf/tools/microsoft-graph-api-auth</span></a><span style="font-family:等线; font-size:11pt">获取</span><span style="font-family:等线; font-size:11pt">refresh</span><span style="font-family:等线; font-size:11pt">-</span><span style="font-family:等线; font-size:11pt">token</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">箭头处填客户端id</span></p><p style="margin:0pt; orphans:0; widows:0"><img src="https://i.xx2007.workers.dev/blog/20210221/398e4245-c56d-4bf4-946f-e02feb20dc6b.011.png" width="554" height="163" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">点Authorize。</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">之后让你登录微软账户</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">然后箭头处填客户端密码</span></p><p style="margin:0pt; orphans:0; widows:0"><img src="https://i.xx2007.workers.dev/blog/20210221/398e4245-c56d-4bf4-946f-e02feb20dc6b.012.png" width="554" height="186" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">点get</span><span style="font-family:等线; font-size:11pt"> token</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">之后得到这些（这幅图是引用别人的，因为我已经做过了，没截图）</span></p><p style="margin:0pt; orphans:0; widows:0"><img src="https://i.xx2007.workers.dev/blog/20210221/398e4245-c56d-4bf4-946f-e02feb20dc6b.013.png" width="553" height="219" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">蓝色部分复制，这是refresh</span><span style="font-family:等线; font-size:11pt">-</span><span style="font-family:等线; font-size:11pt">token</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">打开</span><a style="color:#0563c1" href="https://dash.cloudflare.com"><span style="color:#0563c1; font-family:等线; font-size:11pt; text-decoration:underline">cloudflare</span></a><span style="font-family:等线; font-size:11pt">有账户的注登录，没账户的注册</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">之后进入workers页面</span></p><p style="margin:0pt; orphans:0; widows:0"><img src="https://i.xx2007.workers.dev/blog/20210221/398e4245-c56d-4bf4-946f-e02feb20dc6b.014.png" width="554" height="298" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">点创建work</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">进入</span><a style="color:#0563c1" href="https://www.shanyemangfu.com/go/?url=https://github.com/heymind/OneDrive-Index-Cloudflare-Worker/blob/master/index.js" target="_blank"><span style="color:#0563c1; font-family:等线; font-size:11pt; text-decoration:underline">https://github.com/heymind/OneDrive-Index-Cloudflare-</span><span style="color:#0563c1; font-family:等线; font-size:11pt; text-decoration:underline">Worker/blob/master/index.js</span></a></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">复制里面的代码，粘贴到worker里</span></p><p style="margin:0pt; orphans:0; widows:0"><img src="http://i.xx2007.cf/blog/20210221/398e4245-c56d-4bf4-946f-e02feb20dc6b.015.png" width="554" height="250" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">注意！！</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">从上往下第一个箭头：填refresh</span><span style="font-family:等线; font-size:11pt">-</span><span style="font-family:等线; font-size:11pt">token</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">第二个箭头：填客户端id</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">第三个箭头：填客户端密码</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">第四个箭头：填</span><a style="color:#0563c1" href="https://onetool.xx2007.cf/tools/microsoft-graph-api-auth"><span style="color:#0563c1; font-family:等线; font-size:11pt; text-decoration:underline">https://onetool.xx2007.cf/tools/microsoft-graph-api-auth</span></a></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">第五个箭头：在你的OneDrive里新建一个文件夹用来放分享的东西，填/（那个文件夹的名字）</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">填好之后保存并部署</span></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">完成，</span><span style="font-family:等线; font-size:11pt">转到这个workers的网页看看</span></p><p style="margin:0pt; orphans:0; widows:0"><img src="http://i.xx2007.cf/blog/20210221/398e4245-c56d-4bf4-946f-e02feb20dc6b.016.png" width="554" height="271" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">大功告成！</span></p></p><p style="margin:0pt; orphans:0; widows:0"><span style="font-family:等线; font-size:11pt">本文为小心2007原创，未经允许，禁止转载！</span></p></div><div class="cnzz" style="display: none;">
	        <script src="https://s23.cnzz.com/z_stat.php?id=1277655852&web_id=1277655852" language="JavaScript"></script>
            </div>
            </body></html>